## Codebase Patterns
- Two copies of base.html exist: `src/templates/base.html` (primary, uses blueprint routes) and `templates/base.html` (legacy, uses direct routes). Both must be updated for UI changes.
- Login page (`src/blueprints/auth/templates/auth/login.html`) has its own standalone styles and is NOT based on base.html.
- The app runs on port 8080 by default.
- All authentication is required; login redirects happen via `before_request` hook.
- Mypy has ~60 pre-existing errors in `tools/security.py`, `src/core/security.py`, and various blueprint route files. These are not related to template changes.

---

## 2026-02-03 - US-001
- Dark theme CSS removed and light theme values set as :root defaults (completed in prior iteration)
- Files changed: src/templates/base.html, templates/base.html
- **Learnings for future iterations:**
  - Light theme values are now in :root, no data-theme selectors needed
  - No dark theme CSS blocks remain

---

## 2026-02-03 - US-002
- Removed theme toggle button (.theme-toggle) with sun/moon SVG icons from header in both base.html files
- Removed theme-switching JavaScript (localStorage theme get/set, data-theme attribute manipulation) from both base.html files
- Header layout verified: notification bell remains as the only header action, visually balanced
- No JavaScript errors in browser console after removal
- Mypy typecheck passes (pre-existing errors only, none related to changes)
- Files changed: src/templates/base.html, templates/base.html, prd.json
- **Learnings for future iterations:**
  - The header-actions div now only contains the notification bell button
  - The login page theme toggle is separate (in login.html) and scoped to US-003
  - Cannot log into app without database credentials, so browser verification of authenticated pages requires valid credentials

---

## 2026-02-03 - US-003
- Updated login page `:root` CSS variables from dark theme values to light theme values (--bg: #f8f7ff, --card: #ffffff, --text: #05013f, --text-muted: #5a5680, etc.)
- Removed `data-theme="dark"` attribute from `<html>` element
- Removed `[data-theme="light"]` CSS block (values now in :root)
- Removed theme toggle button HTML (sun/moon SVGs), theme toggle CSS, and theme-switching JavaScript (localStorage, data-theme manipulation)
- Mypy typecheck passes (60 pre-existing errors only, none related to changes)
- Files changed: src/blueprints/auth/templates/auth/login.html, prd.json
- **Learnings for future iterations:**
  - Login page is now fully light-only with no theme switching capability
  - Login page CSS variables now match the base.html light theme values for consistency

---

## 2026-02-03 - US-004
- Added `APP_VERSION` config variable to base `Config` class, read via `os.environ.get("APP_VERSION", "v2.0")`
- Added `@app.context_processor` in `create_app()` to inject `app_version` into all Jinja2 templates
- Mypy typecheck passes (60 pre-existing errors only, none related to changes)
- Files changed: src/config.py, src/app.py, prd.json
- **Learnings for future iterations:**
  - `app_version` is now available in all templates via the context processor
  - The context processor reads from `app.config` which inherits from the Config class

---
