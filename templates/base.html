<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}NOC Toolkit{% endblock %}</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      --bg: #0b1020;
      --card: #0f172a;
      --muted: #94a3b8;
      --text: #e5e7eb;
      --accent: #4f46e5;
      --accent-2: #06b6d4;
      --border: rgba(148,163,184,.18);
      --shadow: 0 10px 30px rgba(2,6,23,.35);
      --radius: 14px;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --info: #3b82f6;
      --sidebar-width: 260px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f5f7fb; --card: #ffffff; --muted: #6b7280; --text: #0f172a;
        --accent: #4f46e5; --accent-2: #06b6d4;
        --border: rgba(17,24,39,.06); --shadow: 0 10px 30px rgba(15,23,42,.08);
        --success: #059669;
        --warning: #d97706;
        --error: #dc2626;
        --info: #2563eb;
      }
    }
    *,*::before,*::after{box-sizing:border-box;}
    html,body{height:100%; margin:0; padding:0;}
    body{
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(60vmax 60vmax at 10% -10%, rgba(79,70,229,.18), transparent 60%),
        radial-gradient(60vmax 60vmax at 110% 10%, rgba(6,182,212,.18), transparent 60%),
        var(--bg);
      display:flex;
      flex-direction:column;
      min-height: 100vh;
    }

    /* Layout with sidebar */
    .app-layout{display:flex; flex:1; overflow:hidden;}
    .sidebar{
      width:var(--sidebar-width);
      background: color-mix(in oklab, var(--card) 85%, transparent);
      border-right:1px solid var(--border);
      overflow-y:auto;
      flex-shrink:0;
      transition: transform 0.3s ease;
      display:flex;
      flex-direction:column;
    }
    .sidebar.hidden{transform:translateX(-100%);}
    .main-content{flex:1; overflow-y:auto; display:flex; flex-direction:column;}
    .shell{max-width:1400px; width:100%; margin:0 auto; padding:24px; flex:1;}

    /* Header */
    header.header{
      background: color-mix(in oklab, var(--card) 90%, transparent);
      border-bottom:1px solid var(--border);
      padding:16px 24px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      position:sticky;
      top:0;
      z-index:100;
      backdrop-filter:blur(10px);
    }
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:40px; height:40px; border-radius:12px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); box-shadow:var(--shadow); display:grid; place-items:center; color:#fff; font-weight:900; font-size:16px;}
    .brand h1{margin:0; font-size: clamp(20px,3vw,24px)}
    .brand .sub{color:var(--muted); font-size:12px; margin-top:2px}
    .header-actions{display:flex; gap:10px; align-items:center;}
    .menu-toggle{
      display:none;
      background:transparent;
      border:1px solid var(--border);
      color:var(--text);
      padding:8px;
      border-radius:8px;
      cursor:pointer;
      width:36px;
      height:36px;
      align-items:center;
      justify-content:center;
    }
    @media (max-width: 768px){
      .menu-toggle{display:flex;}
      .sidebar{position:fixed; left:0; top:0; bottom:0; z-index:200; box-shadow:var(--shadow);}
      .sidebar.hidden{transform:translateX(-100%);}
      .sidebar-overlay{
        position:fixed;
        inset:0;
        background:rgba(0,0,0,0.5);
        z-index:199;
        display:none;
      }
      .sidebar-overlay.active{display:block;}
    }
    a.btn,button.btn{
      background:transparent; color:var(--text); border:1px solid var(--border);
      padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600;
      transition:.18s ease; text-decoration:none; display:inline-flex; align-items:center; gap:8px;
    }
    .btn:hover{transform:translateY(-1px); border-color:var(--accent)}
    .btn.primary{background:linear-gradient(135deg,var(--accent),var(--accent-2)); border-color:transparent; color:#fff; box-shadow:var(--shadow)}
    .btn.primary:hover{filter:brightness(1.07)}

    /* New reusable gradient button class */
    .btn-gradient {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #fff;
      font-weight: 600;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      box-shadow: var(--shadow);
      cursor: pointer;
      transition: transform 0.15s ease, filter 0.15s ease;
      text-decoration: none;
      display: inline-block;
    }
    .btn-gradient:hover {
      transform: scale(1.05);
      filter: brightness(1.08);
    }

    /* Cards & form layout */
    .card{
      background: color-mix(in oklab, var(--card) 92%, transparent);
      border:1px solid var(--border); border-radius:var(--radius); padding:22px; box-shadow:var(--shadow);
    }
    .grid{display:grid; gap:14px}
    .row{display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start}
    .field{display:flex; flex-direction:column; gap:6px; flex: 1 1 260px; min-width: 220px}
    label{font-weight:600; font-size:14px}
    input[type="text"], input[type="password"], textarea, select{
      width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:10px; background:var(--card); color:var(--text);
      box-sizing:border-box; -webkit-appearance:none; appearance:none;
    }
    input[type="text"], input[type="password"]{line-height:1.3; min-height:40px}
    textarea{min-height:120px; line-height:1.35}
    .muted{color:var(--muted); font-size:13px}
    .flash{background:#fef3c7; border:1px solid #facc15; color:#78350f; padding:8px 10px; border-radius:10px; margin-bottom:12px}
    .section-title{margin:0 0 8px 0}
    table{width:100%; border-collapse: collapse}
    th,td{border:1px solid var(--border); padding:8px; text-align:left; font-size:14px}
    th{background: color-mix(in oklab, var(--card) 94%, transparent)}

    .host-selector{position:relative}
    .host-selector-results{
      margin-top:6px;
      border:1px solid var(--border);
      border-radius:10px;
      background: color-mix(in oklab, var(--card) 96%, transparent);
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
      max-height:220px;
      overflow-y:auto;
    }
    .host-selector-item{
      background:none;
      border:none;
      padding:8px 10px;
      text-align:left;
      color:var(--text);
      cursor:pointer;
      border-bottom:1px solid var(--border);
    }
    .host-selector-item:last-child{border-bottom:none}
    .host-selector-item:hover{background: color-mix(in oklab, var(--card) 88%, transparent);}
    .host-selector-primary{font-weight:600;}
    .host-selector-secondary{font-size:12px; color:var(--muted);}

    /* Sidebar Navigation */
    .sidebar-header{padding:20px 16px; border-bottom:1px solid var(--border);}
    .sidebar-logo{font-size:18px; font-weight:700; color:var(--text); text-decoration:none; display:flex; align-items:center; gap:10px;}
    .sidebar-nav{padding:12px 0; flex:1; display:flex; flex-direction:column;}
    .nav-section{margin-bottom:8px;}
    .nav-section-title{
      padding:8px 16px;
      font-size:11px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:0.05em;
      color:var(--muted);
    }
    .nav-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 16px;
      color:var(--text);
      text-decoration:none;
      transition:background 0.15s ease;
      border-left:3px solid transparent;
    }
    .nav-item:hover{background: color-mix(in oklab, var(--card) 70%, transparent);}
    .nav-item.active{
      background: color-mix(in oklab, var(--accent) 15%, transparent);
      border-left-color:var(--accent);
      color:var(--accent);
      font-weight:600;
    }
    .nav-icon{width:18px; height:18px; opacity:0.8;}
    .nav-badge{
      margin-left:auto;
      background:var(--error);
      color:#fff;
      font-size:10px;
      font-weight:700;
      padding:2px 6px;
      border-radius:10px;
      min-width:18px;
      text-align:center;
    }

    /* Breadcrumbs */
    .breadcrumbs{
      display:flex;
      align-items:center;
      gap:8px;
      margin-bottom:16px;
      font-size:13px;
      color:var(--muted);
      flex-wrap:wrap;
    }
    .breadcrumbs a{color:var(--muted); text-decoration:none; transition:color 0.15s;}
    .breadcrumbs a:hover{color:var(--accent);}
    .breadcrumbs-separator{opacity:0.5;}
    .breadcrumbs-current{color:var(--text); font-weight:600;}

    /* Status Badges */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:4px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:600;
      line-height:1;
    }
    .badge.success{background:color-mix(in oklab, var(--success) 15%, transparent); color:var(--success);}
    .badge.warning{background:color-mix(in oklab, var(--warning) 15%, transparent); color:var(--warning);}
    .badge.error{background:color-mix(in oklab, var(--error) 15%, transparent); color:var(--error);}
    .badge.info{background:color-mix(in oklab, var(--info) 15%, transparent); color:var(--info);}
    .badge.neutral{background:color-mix(in oklab, var(--muted) 15%, transparent); color:var(--muted);}

    /* Toast Notifications */
    .toast-container{
      position:fixed;
      top:80px;
      right:24px;
      z-index:9999;
      display:flex;
      flex-direction:column;
      gap:10px;
      max-width:400px;
    }
    .toast{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px 16px;
      box-shadow:var(--shadow);
      display:flex;
      align-items:flex-start;
      gap:12px;
      animation:slideIn 0.3s ease;
    }
    @keyframes slideIn{from{transform:translateX(120%); opacity:0;} to{transform:translateX(0); opacity:1;}}
    .toast-icon{width:20px; height:20px; flex-shrink:0; margin-top:2px;}
    .toast-content{flex:1; min-width:0;}
    .toast-title{font-weight:600; font-size:14px; margin-bottom:2px;}
    .toast-message{font-size:13px; color:var(--muted);}
    .toast-close{
      background:none;
      border:none;
      color:var(--muted);
      cursor:pointer;
      padding:0;
      width:20px;
      height:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      opacity:0.6;
      transition:opacity 0.15s;
    }
    .toast-close:hover{opacity:1;}
    .toast.success .toast-icon{color:var(--success);}
    .toast.warning .toast-icon{color:var(--warning);}
    .toast.error .toast-icon{color:var(--error);}
    .toast.info .toast-icon{color:var(--info);}

    /* Notification Bell */
    .notification-bell{
      position:relative;
      background:transparent;
      border:1px solid var(--border);
      color:var(--text);
      padding:10px;
      border-radius:10px;
      cursor:pointer;
      transition:all 0.15s ease;
    }
    .notification-bell:hover{border-color:var(--accent); transform:translateY(-1px);}
    .notification-bell-badge{
      position:absolute;
      top:-4px;
      right:-4px;
      background:var(--error);
      color:#fff;
      font-size:10px;
      font-weight:700;
      padding:2px 5px;
      border-radius:10px;
      min-width:18px;
      text-align:center;
    }

    /* Footer */
    .footer{
      margin-top:auto;
      padding:16px 24px;
      border-top: 1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      color: var(--muted);
      font-size: 12px;
      background: color-mix(in oklab, var(--card) 70%, transparent);
    }
    .footer span:last-child{text-align:right;}

    /* Admin login button - bottom left */
    .admin-login-btn{
      position:fixed;
      bottom:20px;
      left:20px;
      z-index:1000;
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 16px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color:#fff;
      border:none;
      border-radius:10px;
      font-size:13px;
      font-weight:600;
      text-decoration:none;
      box-shadow: 0 4px 15px rgba(79,70,229,0.3);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .admin-login-btn:hover{
      transform:translateY(-2px);
      box-shadow: 0 6px 20px rgba(79,70,229,0.4);
    }
    .admin-login-btn.superadmin{
      background: linear-gradient(135deg, var(--error), #dc2626);
      box-shadow: 0 4px 15px rgba(239,68,68,0.3);
    }
    .admin-login-btn.superadmin:hover{
      box-shadow: 0 6px 20px rgba(239,68,68,0.4);
    }

    @media (max-width: 768px){
      .footer{flex-direction:column; text-align:center;}
      .shell{padding:16px;}
    }
  </style>
  {% block head_extra %}{% endblock %}
</head>
<body>
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <header class="header">
    <button class="menu-toggle" id="menuToggle" aria-label="Toggle Menu">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 6h14M3 10h14M3 14h14"/>
      </svg>
    </button>
    <div class="brand">
      <a href="{{ url_for('index') }}" class="logo" aria-label="Home">NT</a>
      <div>
        <h1>NOC Toolkit</h1>
      </div>
    </div>
    <div class="header-actions">
      <button class="notification-bell" id="notificationBell" aria-label="Notifications">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM8 16a2 2 0 104 0"/>
        </svg>
        <span class="notification-bell-badge" id="notificationCount" style="display:none;">0</span>
      </button>
    </div>
  </header>

  <div class="app-layout">
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-nav" style="padding-top:8px;">
        <div class="nav-section">
          <div class="nav-section-title">Main</div>
          <a href="{{ url_for('index') }}" class="nav-item {% if request.endpoint == 'index' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 4h14M3 10h14M3 16h14"/>
            </svg>
            <span>Dashboard</span>
          </a>
          <a href="{{ url_for('jobs_center') }}" class="nav-item {% if request.endpoint == 'jobs_center' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h6a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h0a2 2 0 002-2M9 5a2 2 0 012-2h0a2 2 0 012 2"/>
            </svg>
            <span>Jobs Center</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Config Tools</div>
          <a href="{{ url_for('tool_phrase_search') }}" class="nav-item {% if request.endpoint == 'tool_phrase_search' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="9" r="6"/><path d="M14 14l4 4"/>
            </svg>
            <span>Interface Search</span>
          </a>
          <a href="{{ url_for('tool_global_config') }}" class="nav-item {% if request.endpoint == 'tool_global_config' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM2 10h16"/>
            </svg>
            <span>Global Config</span>
          </a>
          <a href="{{ url_for('bulk_ssh') }}" class="nav-item {% if request.endpoint in ['bulk_ssh', 'bulk_ssh_execute', 'bulk_ssh_results', 'bulk_ssh_jobs', 'bulk_ssh_templates', 'bulk_ssh_schedules'] %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="5" width="16" height="10" rx="2"/><path d="M5 8l3 3-3 3M11 12h3"/>
            </svg>
            <span>Bulk SSH Terminal</span>
          </a>
          {% if session.get('role') == 'superadmin' %}
          <a href="{{ url_for('audit_logs') }}" class="nav-item {% if request.endpoint == 'audit_logs' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span>Audit Logs</span>
          </a>
          {% endif %}
        </div>

        <div class="nav-section">
          <div class="nav-section-title">WLC Tools</div>
          <a href="{{ url_for('wlc_dashboard') }}" class="nav-item {% if request.endpoint == 'wlc_dashboard' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M7 16V4m6 0v12"/>
            </svg>
            <span>Dashboard</span>
          </a>
          <a href="{{ url_for('wlc_inventory') }}" class="nav-item {% if request.endpoint == 'wlc_inventory' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 6h12M4 10h12M4 14h12"/>
            </svg>
            <span>AP Inventory</span>
          </a>
          <a href="{{ url_for('wlc_rf') }}" class="nav-item {% if request.endpoint == 'wlc_rf' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M8.111 16.404a5.5 5.5 0 017.778 0M12 12m-2 0a2 2 0 104 0 2 2 0 00-4 0z"/>
            </svg>
            <span>RF Summary</span>
          </a>
          <a href="{{ url_for('wlc_summer_guest') }}" class="nav-item {% if request.endpoint == 'wlc_summer_guest' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="10" cy="10" r="8"/><path d="M10 6v4l3 3"/>
            </svg>
            <span>Summer Guest</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Infrastructure</div>
          <a href="{{ url_for('solarwinds_nodes') }}" class="nav-item {% if request.endpoint == 'solarwinds_nodes' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 3v4M3 5h4M6 17v-3l-1.5-1.5M18 5h-4M17 3v4M13.5 17l-1.5-1.5V17M10 10l-2-2m8 8l-2-2m-4 0l-2 2m8-8l-2 2"/>
            </svg>
            <span>SolarWinds Nodes</span>
          </a>
          <a href="{{ url_for('topology_tool') }}" class="nav-item {% if request.endpoint == 'topology_tool' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="5" cy="5" r="2"/><circle cx="15" cy="5" r="2"/><circle cx="10" cy="15" r="2"/>
              <path d="M7 6l6 0M6 7l3 6M14 7l-3 6"/>
            </svg>
            <span>Topology</span>
          </a>
          <a href="{{ url_for('changes_list') }}" class="nav-item {% if request.endpoint == 'changes_list' %}active{% endif %}">
            <svg class="nav-icon" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="14" height="12" rx="2"/><path d="M3 8h14"/>
            </svg>
            <span>Change Windows</span>
          </a>
        </div>

        {% if session.get('user_id') %}
        <div style="margin-top:auto; padding:16px; border-top:1px solid var(--border);">
          <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
            <div style="width:32px; height:32px; border-radius:50%; background:linear-gradient(135deg, var(--accent), var(--accent-2)); display:flex; align-items:center; justify-content:center; color:white; font-weight:600; font-size:14px;">
              {{ session.get('username', 'U')[0].upper() }}
            </div>
            <div style="flex:1; min-width:0;">
              <div style="font-size:13px; font-weight:600; color:var(--text); overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
                {{ session.get('username', 'User') }}
              </div>
              <div style="font-size:11px; color:var(--muted); text-transform:capitalize;">
                {{ session.get('role', 'user') }}
              </div>
            </div>
          </div>
          <div style="display:flex; gap:6px;">
            <a href="{{ url_for('profile') }}" class="btn" style="flex:1; padding:8px; font-size:12px; text-align:center;">Profile</a>
            <a href="{{ url_for('logout') }}" class="btn" style="flex:1; padding:8px; font-size:12px; text-align:center;">Logout</a>
          </div>
          {% if session.get('role') == 'superadmin' %}
          <a href="{{ url_for('admin_users') }}" class="btn" style="width:100%; padding:8px; font-size:12px; text-align:center; margin-top:6px; background:linear-gradient(135deg, var(--error), #dc2626); color:white;">Admin Panel</a>
          {% endif %}
        </div>
        {% endif %}
      </div>
    </nav>

    <div class="main-content">
      <main class="shell">
        {% if breadcrumbs %}
        <nav class="breadcrumbs" aria-label="Breadcrumb">
          {% for crumb in breadcrumbs %}
            {% if loop.last %}
              <span class="breadcrumbs-current">{{ crumb.title }}</span>
            {% else %}
              <a href="{{ crumb.url }}">{{ crumb.title }}</a>
              <span class="breadcrumbs-separator">/</span>
            {% endif %}
          {% endfor %}
        </nav>
        {% endif %}

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for m in messages %}
              <div class="flash">{{ m }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
      </main>

      <footer class="footer">
      </footer>
    </div>
  </div>

  <div class="toast-container" id="toastContainer"></div>

  <!-- Admin Login Button - Bottom Left (only when not logged in) -->
  {% if not session.get('user_id') %}
  <a href="{{ url_for('login') }}" class="admin-login-btn">
    <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
    </svg>
    <span>Admin Login</span>
  </a>
  {% endif %}

  <script>
    // Sidebar toggle for mobile
    const sidebar = document.getElementById('sidebar');
    const menuToggle = document.getElementById('menuToggle');
    const sidebarOverlay = document.getElementById('sidebarOverlay');

    function toggleSidebar(){
      sidebar.classList.toggle('hidden');
      sidebarOverlay.classList.toggle('active');
    }

    if(menuToggle){
      menuToggle.addEventListener('click', toggleSidebar);
    }
    if(sidebarOverlay){
      sidebarOverlay.addEventListener('click', toggleSidebar);
    }

    // Toast notification system
    window.showToast = function(title, message, type = 'info', duration = 5000){
      const container = document.getElementById('toastContainer');
      if(!container) return;

      const toast = document.createElement('div');
      toast.className = `toast ${type}`;

      const icons = {
        success: '<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/></svg>',
        error: '<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"/></svg>',
        warning: '<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"/></svg>',
        info: '<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"/></svg>'
      };

      toast.innerHTML = `
        ${icons[type] || icons.info}
        <div class="toast-content">
          <div class="toast-title">${title}</div>
          ${message ? `<div class="toast-message">${message}</div>` : ''}
        </div>
        <button class="toast-close" onclick="this.parentElement.remove()">
          <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"/>
          </svg>
        </button>
      `;

      container.appendChild(toast);

      if(duration > 0){
        setTimeout(() => {
          toast.style.opacity = '0';
          toast.style.transform = 'translateX(120%)';
          setTimeout(() => toast.remove(), 300);
        }, duration);
      }
    };

  </script>
  {% block scripts %}{% endblock %}
</body>
</html>
